<!DOCTYPE html>
<html lang="fr"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout.html">
<head>
    <title layout:fragment="title">Liste des Ventes</title>
</head>
<body>
<section layout:fragment="content" class="max-w-7xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6">Liste des Ventes</h1>
    <form method="get" action="/listeVentes" class="mb-6">
        <div class="flex gap-4">
            <div>
                <label for="nomArticle" class="block font-medium">Nom de l'Article</label>
                <input type="text" id="nomArticle" name="nomArticle" 
                       th:value="${param.nomArticle}" class="border p-2 rounded">
            </div>
            <div>
                <label for="categorie" class="block font-medium">Catégorie</label>
                <select id="categorie" name="categorie" class="border p-2 rounded">
                    <option value="">--Toutes les catégories--</option>
                    <th:block th:each="cat : ${categories}">
                        <option th:value="${cat.noCategorie}" 
                                th:text="${cat.libelle}"
                                th:selected="${cat.noCategorie == selectedCategorie}"></option>
                    </th:block>
                </select>
            </div>
            <button type="submit" class="bg-blue-500 text-white p-2 rounded mt-6">Filtrer</button>
        </div>
    </form>
    <table class="min-w-full border-collapse border border-gray-300">
        <thead>
                <tr class="bg-gray-100">
                    <th class="border border-gray-300 p-2">Nom de l'Article</th>
                    <th class="border border-gray-300 p-2">Description</th>
                    <th class="border border-gray-300 p-2">Catégorie</th>
                    <th class="border border-gray-300 p-2">Mise à Prix</th>
                    <th class="border border-gray-300 p-2">Début des Enchères</th>
                    <th class="border border-gray-300 p-2">Fin des Enchères</th>
                    <th class="border border-gray-300 p-2">Vendeur</th>
                    <th class="border border-gray-300 p-2">Lieu de la vente</th>
                    <th class="border border-gray-300 p-2">Détails</th>
                </tr>
        </thead>
        <tbody>
            <tr th:each="article : ${lesArticlesVendus}" class="hover:bg-gray-50">
                <td class="border border-gray-300 p-2" th:text="${article.nomArticle}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.description}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.categorie.libelle}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.prixInitial}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.dateDebutEncheres}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.dateFinEncheres}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.vendeur.prenom + ' ' + article.vendeur.nom}"></td>
                <td class="border border-gray-300 p-2" th:text="${article.retrait.rue + ' ' + article.retrait.codePostal + ' ' + article.retrait.ville}"></td>
                <td class="border border-gray-300 p-2 text-center">
                    <a th:href="@{'/vente/' + ${article.noArticle}}" class="text-blue-500 hover:underline">Voir détails</a>
                </td>
            </tr>
        </tbody>
    </table>
</section>
</body>
</html>
